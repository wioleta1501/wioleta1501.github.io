<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animacja2</title>
</head>
<body>
<canvas id="myGame" width="800" height="600" style="background-color: black" style="border:2px solid black;">
    Your browser does not support the HTML canvas tag.</canvas>

<script>
    let c = document.getElementById("myGame");

    window.addEventListener("keydown", moveCar, false);

    let ctx = c.getContext("2d");
    let carX = (c.width - 40) / 2;
    let carY = c.height-100;
    let carWidth = 40;
    let carHeight = 60;
    let backgroundDelay = 0;

    car_image = new Image();
    car_image.src = 'assets/car.png';
    car_image.onload = function() {
        drawCar();
    }

    straight1_image = new Image();
    straight1_image.src = 'assets/straight1.png'
    straight1_image.onload = function () {
        drawBackground();
    }

    straight2_image = new Image();
    straight2_image.src = 'assets/straight2.png'
    straight2_image.onload = function () {
        drawBackground();
    }

    straight3_image = new Image();
    straight3_image.src = 'assets/straight3.png'
    straight3_image.onload = function () {
        drawBackground();
    }

    straight4_image = new Image();
    straight4_image.src = 'assets/straight4.png'
    straight4_image.onload = function () {
        drawBackground();
    }

    function refresh() {
        ctx.clearRect(0, 0, 800, 600);
        drawBackground();
        drawCar();
    }
    window.setInterval(refresh,50);

    refresh();

    function moveCar(e) {
        switch(e.keyCode) {
            case 37:
            case 65:
                if(carX !=200){
                    carX -= 20;
                }
                break;
            case 39:
            case 68:
                if(carX != c.width-240){
                    carX += 20;
                }
                break;
        }
    }

    function drawCar(){
        ctx.beginPath();
        ctx.drawImage(car_image, carX, carY, carWidth, carHeight)
    }

    function drawBackground() {
        ctx.beginPath()
        ctx.drawImage(straight1_image, 0, 0, 800, 600)
        backgroundDelay += 10;
        if(backgroundDelay>=20) {
            ctx.drawImage(straight2_image, 0, 0, 800, 600)
        }
        if(backgroundDelay>=40) {
            ctx.drawImage(straight3_image, 0, 0, 800, 600)
        }
        if(backgroundDelay>=60) {
            backgroundDelay = 0;
            ctx.drawImage(straight4_image, 0, 0, 800, 600)
        }
    }

</script>

</body>
</html>